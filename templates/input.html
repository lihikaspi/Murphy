{% extends "base.html" %}

{% block content %}
{% set is_mock = session.get('db_user_id', -1) == -1 %}

<section class="max-w-8xl mx-auto py-10">
    <div class="mb-10 text-center md:text-left">
        <h1 class="text-4xl font-extrabold text-slate-900 tracking-tight mb-3">Stress-Test Your Strategy</h1>
        <p class="text-lg text-slate-500">The Time Traveler is waiting to report from your failed timeline.</p>
    </div>

    <form action="/process_input" method="POST" class="space-y-6 mb-10">
        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
            <label class="flex items-center text-[15px] font-bold text-slate-900 uppercase tracking-wider mb-4">
                <i data-lucide="user" class="w-4 h-4 text-indigo-500 mr-2"></i> User Information <span class="text-red-500 ml-1">*</span>
            </label>
            <textarea name="about" required {{ 'readonly' if is_mock }}
                      class="w-full h-24 p-3 bg-slate-50 border-0 rounded-xl text-slate-700 resize-none text-[16px] leading-relaxed focus:ring-2 focus:ring-indigo-500 {{ 'opacity-50 cursor-not-allowed' if is_mock }}"
                      placeholder="e.g. Solo founder, limited budget, technical background...">{{ data.about if data else '' }}</textarea>
        </div>

        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
            <label class="flex items-center text-[15px] font-bold text-slate-900 uppercase tracking-wider mb-4">
                <i data-lucide="target" class="w-4 h-4 text-emerald-500 mr-2"></i> The Goal / Purpose <span class="text-red-500 ml-1">*</span>
            </label>
            <textarea name="goal" required {{ 'readonly' if is_mock }}
                      class="w-full h-15 p-3 bg-slate-50 border-0 rounded-xl text-slate-700 resize-none text-[16px] leading-relaxed focus:ring-2 focus:ring-emerald-500 {{ 'opacity-50 cursor-not-allowed' if is_mock }}"
                      placeholder="e.g. reach $2k in monthly recurring revenue...">{{ data.goal if data else '' }}</textarea>
        </div>

        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
            <label class="flex items-center text-[15px] font-bold text-slate-900 uppercase tracking-wider mb-4">
                <i data-lucide="map" class="w-4 h-4 text-blue-500 mr-2"></i> The Current Plan <span class="text-red-500 ml-1">*</span>
            </label>
            <textarea name="plan" required {{ 'readonly' if is_mock }}
                      class="w-full h-40 p-3 bg-slate-50 border-0 rounded-xl text-slate-700 resize-none text-[16px] leading-relaxed focus:ring-2 focus:ring-blue-500 {{ 'opacity-50 cursor-not-allowed' if is_mock }}"
                      placeholder="Step 1: Build...&#10;Step 2: Launch...">{{ data.plan if data else '' }}</textarea>
        </div>

        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
            <label class="flex items-center text-[15px] font-bold text-slate-900 uppercase tracking-wider mb-4">
                <i data-lucide="alert-circle" class="w-4 h-4 text-amber-500 mr-2"></i> Self-Reflection / Concerns
            </label>
            <textarea name="wrong" {{ 'readonly' if is_mock }}
                      class="w-full h-24 p-3 bg-slate-50 border-0 rounded-xl text-slate-700 resize-none text-[16px] leading-relaxed focus:ring-2 focus:ring-amber-500 {{ 'opacity-50 cursor-not-allowed' if is_mock }}"
                      placeholder="What do you think could go wrong? (Optional)">{{ data.wrong if data else '' }}</textarea>
        </div>

        <div class="bg-white p-6 rounded-2xl shadow-xl border border-slate-100 flex flex-col md:flex-row items-center justify-between gap-8 sticky bottom-6 z-30">
            <div class="w-full md:w-3/4">
                <label class="block text-[14px] font-bold text-slate-500 uppercase tracking-wider mb-3">Murphy's Law Severity</label>
                <div class="relative">
                    <select name="pessimism" {{ 'disabled' if is_mock }}
                            class="w-full appearance-none bg-slate-50 border border-slate-200 rounded-xl px-4 py-4 text-slate-900 font-bold focus:ring-2 focus:ring-slate-900 focus:outline-none cursor-pointer transition-all {{ 'opacity-50' if is_mock }}">
                        <option value="Optimistic" {% if data.pessimism == 'Optimistic' %}selected{% endif %}>Optimistic (Minor Hiccups)</option>
                        <option value="Slightly Concerned" {% if data.pessimism == 'Slightly Concerned' %}selected{% endif %}>Slightly Concerned</option>
                        <option value="Realistic" {% if not data or not data.pessimism or data.pessimism == 'Realistic' %}selected{% endif %}>Realistic (Standard Failure)</option>
                        <option value="Pessimistic" {% if data.pessimism == 'Pessimistic' %}selected{% endif %}>Pessimistic (Critical Obstacles)</option>
                        <option value="Total Chaos" {% if data.pessimism == 'Total Chaos' %}selected{% endif %}>Total Chaos (Black Swan)</option>
                    </select>
                    <div class="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400">
                        <i data-lucide="chevron-down" class="w-8 h-5"></i>
                    </div>
                </div>
            </div>

            <button type="submit"
                {{ 'disabled' if is_mock else '' }}
                class="w-full md:w-auto px-20 py-5 bg-slate-900 text-white font-bold rounded-xl shadow-xl hover:bg-slate-800 transition-all flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed">
                Start <i data-lucide="arrow-right" class="w-5 h-5"></i>
            </button>
        </div>
    </form>
</section>
{% endblock %}